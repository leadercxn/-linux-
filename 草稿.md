/*            
 提供如下变量可直接使用:            
 app     : Object, iot 平台需要的字段             
 lora     : Object, lora 平台需要的字段             
 config     : Object, 最终的配置结果放入此字段内即可完成配置             
 defaultConfig    : Object, 默认字段集            
 */ 
const DEVICE_TYPE = {
    NODE = 0;
    MODULE = 1;
    CHIP = 2;
    CO = 3;
    CO2 = 4;
    NO2 = 5;
    CH4 = 6;
    LPG = 7;
    PM2_5 = 8;
    PM10 = 9;
    GPS = 10;
    TEMP = 11;
    HUMI = 12;
    TRACKER = 13;
    chip_s = 14;
    chip_e = 15;
    chip_l = 16;
    tester = 17;
    temp_humi_one = 18;
    fhsj_ch4 = 19;
    fhsj_lpg = 20;
    fhsj_elec_fires = 21;
    fhsj_smoke = 22;
    tk = 23;
    concox_tracker = 24;
    jf_connection = 25;
    siter_lpg = 26;
    mantun_fires = 27;
    acrel_fires = 28;
    taycan_smoke = 29;
    bigbang_tracker = 30;
    t1 = 31;
    acrel_single = 32;
    baymax_ch4 = 33;
    baymax_lpg = 34;
    jetfire_water_soak = 47;

    sss_door = 51;
    sss_pir = 52;

    hiwits_water = 60;
};

const CLASS = {
    A: 'A',
    B: 'B',
    C: 'C',
    G: 'G',
};

const ACTIVATION = {
    ABP: 'ABP',
    OTAA: 'OTAA'
}

function getClassTypeIndex(classType) {
    if (classType === CLASS.A) {
      return 0;
    } else if (classType === CLASS.B) {
      return 1;
    } else if (classType === CLASS.C) {
      return 2;
    } else if (classType === CLASS.G) {
      return 3;
    }
}

function getActivationIndex(activation) {
    if (activation === ACTIVATION.ABP) {
      return 0;
    } else if (activation === ACTIVATION.OTAA) {
      return 1;
    }
}


// 修改lora默认参数
lora.classType = CLASS.A;
lora.activation = ACTIVATION.ABP;
lora.adr = false;
lora.txPower = 1;
lora.maxEIRP = 20;
lora.joinAcceptDelay = 5;
lora.rx2DataRate = 1;

// lora 配置参数填充
config.loraActivation = getActivationIndex(lora.activation);
config.loraClassType = getClassTypeIndex(lora.classType);
config.loraEui = new Buffer(lora.EUI, 'hex');
config.loraAppEui = new Buffer(lora.appEUI, 'hex');
config.loraNetId = new Buffer(lora.netId, 'hex');
config.loraAppKey = new Buffer(lora.appKey, 'hex');
config.loraNwkSKey = new Buffer(lora.nwkSKey, 'hex');
config.loraAppSKey = new Buffer(lora.appSKey, 'hex');
config.loraAppNonce = new Buffer(lora.appNonce, 'hex');
config.loraDevNonce = new Buffer(lora.devNonce, 'hex');
config.loraDevAddr = new Buffer(lora.devAddr, 'hex');
config.loraBands = lora.bands;
config.loraTxPower = lora.txPower;
config.loraDataRate = lora.dataRate;
config.loraAdr = lora.adr;
config.loraDelay = lora.delay;
config.loraJoinDelay = lora.joinAcceptDelay;
config.loraRx2DataRate = lora.rx2DataRate;
config.loraRx2Frequency = lora.rx2Frequency;
config.loraMaxEIRP = lora.maxEIRP;
config.loraRx1DRoffset = lora.rx1DRoffset;
config.loraNbTrans = lora.nbTrans;
config.loraChannelMask = lora.channelMask;
config.loraMaxDutyCycle = lora.maxDutyCycle;
config.loraSglFrequency = 486300000;
config.loraSglDatarate = 3;
config.loraSglEnabled = 0;

//12小时一次心跳
app.interval = 43200;

//蓝牙广播间隔400ms
app.bleInterval = 400;

config.appDeviceType = DEVICE_TYPE.hiwits_water;
config.appSn = new Buffer(defaultConfig.sn, 'hex');
config.appToken = new Buffer(defaultConfig.token);
config.appHardwareversion = new Buffer(defaultConfig.hardwareVersion, 'hex');
config.appSecureKey = new Buffer(app.secureKey, 'hex');
config.appPassword = new Buffer(app.password);
config.appInterval = app.interval;
config.appBleTxPower = app.bleTxPower;
config.appBleInterval = app.bleInterval;
config.appAlarmReportIntervalAcked = 600;
config.appAlarmReportIntervalUnAcked = 60;
config.appAlarmReport_nb=3;
config.appReportRepeat = 1;

config.app = app;
config.lora = lora;
